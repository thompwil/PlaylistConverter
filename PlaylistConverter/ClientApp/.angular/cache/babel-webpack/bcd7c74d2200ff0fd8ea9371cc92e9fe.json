{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\wiljt\\\\source\\\\repos\\\\PlaylistConverter\\\\PlaylistConverter\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\n\nfunction ConverterComponent_div_9_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const song_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", song_r4.title, \" - \", song_r4.artists[0], \" \");\n  }\n}\n\nfunction ConverterComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelementStart(1, \"h2\");\n    i0.ɵɵtext(2, \"We found these Spotify songs:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ConverterComponent_div_9_div_3_Template, 2, 2, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.playlist.songs);\n  }\n}\n\nfunction ConverterComponent_div_10_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const song_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", song_r6.attributes.name, \" - \", song_r6.attributes.artistName, \" \");\n  }\n}\n\nfunction ConverterComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelementStart(1, \"h2\");\n    i0.ɵɵtext(2, \"We found these Apple Music songs:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ConverterComponent_div_10_div_3_Template, 2, 2, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.appleSongs);\n  }\n}\n\nfunction ConverterComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelementStart(1, \"h2\");\n    i0.ɵɵtext(2, \"Playlist Created Successfully!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class ConverterComponent {\n  constructor(http, baseUrl) {\n    this.http = http;\n    this.baseUrl = baseUrl;\n    this.linkControl = new FormControl('');\n    this.default = \"https://open.spotify.com/playlist/5aJjvZYiPfszshEDxBcgpZ?si=23064bf926b149ab\";\n    this.token = '';\n    this.appleSongs = [];\n    this.creationSuccesful = false;\n    this.getAppleDevToken();\n  }\n\n  ConfigureMusicKit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      console.log(\"made it!\");\n      let error = false;\n      console.log(_this.token);\n\n      try {\n        yield MusicKit.configure({\n          developerToken: _this.token,\n          app: {\n            name: 'PlaylistConverter',\n            build: '1978.4.1'\n          }\n        });\n      } catch (err) {\n        error = true;\n        console.log(\"got an error\"); // Handle configuration error\n      }\n\n      if (!error) {\n        // MusicKit instance is available\n        _this.music = MusicKit.getInstance();\n\n        _this.testApple();\n      }\n    })();\n  }\n\n  testApple() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const headers = {\n        'Authorization': 'Bearer ' + _this2.token\n      };\n      let something = yield _this2.http.get('https://api.music.apple.com/v1/test', {\n        headers\n      }).toPromise();\n      console.log(something);\n    })();\n  }\n\n  searchSong() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const headers = {\n        'Authorization': 'Bearer ' + _this3.token\n      };\n\n      for (const song of _this3.playlist.songs) {\n        try {\n          let result = yield _this3.http.get('https://api.music.apple.com/v1/catalog/us/search?types=songs,albums,artists&limit=1' + '&term=' + song.title + '+' + song.artists[0], {\n            headers\n          }).toPromise();\n          if (result.results.songs != undefined) _this3.appleSongs.push(result.results.songs.data[0]);\n          console.log(result);\n        } catch (ex) {}\n      }\n    })();\n  }\n\n  getAppleDevToken() {\n    this.http.get(this.baseUrl + 'playlist').subscribe(result => {\n      this.token = result;\n      this.ConfigureMusicKit();\n    }, error => console.error(error));\n  }\n\n  CreatePlaylist() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      const headers = {\n        'Authorization': 'Bearer ' + _this4.token,\n        'Music-User-Token': _this4.music.api.userToken\n      };\n      let result = yield _this4.http.get('https://api.music.apple.com/v1/me/library/playlist-folders?filter[identity]=playlistsroot', {\n        headers\n      }).toPromise();\n      console.log(result);\n      const data = [];\n\n      for (const song of _this4.appleSongs) {\n        let temp = {\n          id: song.id,\n          type: 'songs'\n        };\n        data.push(temp);\n      }\n\n      const tracks = {\n        data: data\n      };\n      const parentData = [{\n        id: result.meta.filters.identity.playlistsroot[0].id,\n        type: 'library-playlist-folders'\n      }];\n      const parent = {\n        data: parentData\n      };\n      const attributes = {\n        description: _this4.playlist.description,\n        name: _this4.playlist.name\n      };\n      const relationships = {\n        tracks: tracks,\n        parent\n      };\n      const dataToSend = {\n        attributes: attributes,\n        relationships: relationships\n      };\n      let playlist = yield _this4.http.post('https://api.music.apple.com/v1/me/library/playlists', JSON.stringify(dataToSend), {\n        headers\n      }).toPromise();\n      console.log(playlist);\n      _this4.creationSuccesful = true;\n    })();\n  }\n\n  onSubmit() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      _this5.appleSongs = []; //this.playlist.songs = [];\n\n      let linkValue = _this5.linkControl.value;\n      const regex = '[0-9A-Za-z]+\\\\?';\n      let found = linkValue.match(regex);\n      let playlistId = found[0].slice(0, -1);\n      let data = {\n        Id: playlistId\n      };\n      const headers = {\n        'content-type': 'application/json'\n      };\n      _this5.playlist = yield _this5.http.post(_this5.baseUrl + 'playlist', JSON.stringify(data), {\n        headers\n      }).toPromise();\n      console.log(_this5.playlist);\n      yield _this5.searchSong();\n      yield _this5.music.authorize();\n\n      _this5.CreatePlaylist();\n    })();\n  }\n\n}\n\nConverterComponent.ɵfac = function ConverterComponent_Factory(t) {\n  return new (t || ConverterComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject('BASE_URL'));\n};\n\nConverterComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ConverterComponent,\n  selectors: [[\"app-converter\"]],\n  decls: 12,\n  vars: 5,\n  consts: [[1, \"align-items-center\", \"pt-5\", \"text-light\"], [1, \"text-center\"], [1, \"container\", \"text-center\", \"pt-5\"], [1, \"pr-5\", \"row\"], [1, \"col\"], [\"type\", \"text\", 1, \"playlist-link\", \"me-3\", \"form-control-lg\", 3, \"ngModel\", \"formControl\", \"ngModelChange\"], [1, \"btn-lg\", \"btn-primary\", 3, \"click\"], [\"class\", \"pt-5\", 4, \"ngIf\"], [1, \"pt-5\"], [4, \"ngFor\", \"ngForOf\"]],\n  template: function ConverterComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"h1\", 1);\n      i0.ɵɵtext(2, \"All we need is the link to your playlist...\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 2);\n      i0.ɵɵelementStart(4, \"div\", 3);\n      i0.ɵɵelementStart(5, \"div\", 4);\n      i0.ɵɵelementStart(6, \"input\", 5);\n      i0.ɵɵlistener(\"ngModelChange\", function ConverterComponent_Template_input_ngModelChange_6_listener($event) {\n        return ctx.default = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function ConverterComponent_Template_button_click_7_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵtext(8, \"Go!\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(9, ConverterComponent_div_9_Template, 4, 1, \"div\", 7);\n      i0.ɵɵtemplate(10, ConverterComponent_div_10_Template, 4, 1, \"div\", 7);\n      i0.ɵɵtemplate(11, ConverterComponent_div_11_Template, 3, 0, \"div\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.default)(\"formControl\", ctx.linkControl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.playlist.songs.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.appleSongs.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.creationSuccesful);\n    }\n  },\n  directives: [i2.DefaultValueAccessor, i2.NgControlStatus, i2.FormControlDirective, i3.NgIf, i3.NgForOf],\n  styles: [\".playlist-link[_ngcontent-%COMP%] {\\r\\n    width: 50%\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnZlcnRlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0k7QUFDSiIsImZpbGUiOiJjb252ZXJ0ZXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5wbGF5bGlzdC1saW5rIHtcclxuICAgIHdpZHRoOiA1MCVcclxufVxyXG4iXX0= */\"]\n});","map":{"version":3,"sources":["C:/Users/wiljt/source/repos/PlaylistConverter/PlaylistConverter/ClientApp/src/app/converter/converter.component.ts"],"names":["FormControl","i0","i1","i2","i3","ConverterComponent_div_9_div_3_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","song_r4","$implicit","ɵɵadvance","ɵɵtextInterpolate2","title","artists","ConverterComponent_div_9_Template","ɵɵtemplate","ctx_r0","ɵɵnextContext","ɵɵproperty","playlist","songs","ConverterComponent_div_10_div_3_Template","song_r6","attributes","name","artistName","ConverterComponent_div_10_Template","ctx_r1","appleSongs","ConverterComponent_div_11_Template","ConverterComponent","constructor","http","baseUrl","linkControl","default","token","creationSuccesful","getAppleDevToken","ConfigureMusicKit","console","log","error","MusicKit","configure","developerToken","app","build","err","music","getInstance","testApple","headers","something","get","toPromise","searchSong","song","result","results","undefined","push","data","ex","subscribe","CreatePlaylist","api","userToken","temp","id","type","tracks","parentData","meta","filters","identity","playlistsroot","parent","description","relationships","dataToSend","post","JSON","stringify","onSubmit","linkValue","value","regex","found","match","playlistId","slice","Id","authorize","ɵfac","ConverterComponent_Factory","t","ɵɵdirectiveInject","HttpClient","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","template","ConverterComponent_Template","ɵɵlistener","ConverterComponent_Template_input_ngModelChange_6_listener","$event","ConverterComponent_Template_button_click_7_listener","length","directives","DefaultValueAccessor","NgControlStatus","FormControlDirective","NgIf","NgForOf","styles"],"mappings":"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","sourcesContent":["import { FormControl } from '@angular/forms';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nimport * as i2 from \"@angular/forms\";\r\nimport * as i3 from \"@angular/common\";\r\nfunction ConverterComponent_div_9_div_3_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\");\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const song_r4 = ctx.$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate2(\" \", song_r4.title, \" - \", song_r4.artists[0], \" \");\r\n} }\r\nfunction ConverterComponent_div_9_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 8);\r\n    i0.ɵɵelementStart(1, \"h2\");\r\n    i0.ɵɵtext(2, \"We found these Spotify songs:\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(3, ConverterComponent_div_9_div_3_Template, 2, 2, \"div\", 9);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.playlist.songs);\r\n} }\r\nfunction ConverterComponent_div_10_div_3_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\");\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const song_r6 = ctx.$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate2(\" \", song_r6.attributes.name, \" - \", song_r6.attributes.artistName, \" \");\r\n} }\r\nfunction ConverterComponent_div_10_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 8);\r\n    i0.ɵɵelementStart(1, \"h2\");\r\n    i0.ɵɵtext(2, \"We found these Apple Music songs:\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(3, ConverterComponent_div_10_div_3_Template, 2, 2, \"div\", 9);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.appleSongs);\r\n} }\r\nfunction ConverterComponent_div_11_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 8);\r\n    i0.ɵɵelementStart(1, \"h2\");\r\n    i0.ɵɵtext(2, \"Playlist Created Successfully!\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} }\r\nexport class ConverterComponent {\r\n    constructor(http, baseUrl) {\r\n        this.http = http;\r\n        this.baseUrl = baseUrl;\r\n        this.linkControl = new FormControl('');\r\n        this.default = \"https://open.spotify.com/playlist/5aJjvZYiPfszshEDxBcgpZ?si=23064bf926b149ab\";\r\n        this.token = '';\r\n        this.appleSongs = [];\r\n        this.creationSuccesful = false;\r\n        this.getAppleDevToken();\r\n    }\r\n    ;\r\n    async ConfigureMusicKit() {\r\n        console.log(\"made it!\");\r\n        let error = false;\r\n        console.log(this.token);\r\n        try {\r\n            await MusicKit.configure({\r\n                developerToken: this.token,\r\n                app: {\r\n                    name: 'PlaylistConverter',\r\n                    build: '1978.4.1',\r\n                },\r\n            });\r\n        }\r\n        catch (err) {\r\n            error = true;\r\n            console.log(\"got an error\");\r\n            // Handle configuration error\r\n        }\r\n        if (!error) {\r\n            // MusicKit instance is available\r\n            this.music = MusicKit.getInstance();\r\n            this.testApple();\r\n        }\r\n    }\r\n    async testApple() {\r\n        const headers = { 'Authorization': 'Bearer ' + this.token };\r\n        let something = await this.http.get('https://api.music.apple.com/v1/test', { headers }).toPromise();\r\n        console.log(something);\r\n    }\r\n    async searchSong() {\r\n        const headers = { 'Authorization': 'Bearer ' + this.token };\r\n        for (const song of this.playlist.songs) {\r\n            try {\r\n                let result = await this.http.get('https://api.music.apple.com/v1/catalog/us/search?types=songs,albums,artists&limit=1' + '&term=' + song.title + '+' + song.artists[0], { headers }).toPromise();\r\n                if (result.results.songs != undefined)\r\n                    this.appleSongs.push(result.results.songs.data[0]);\r\n                console.log(result);\r\n            }\r\n            catch (ex) { }\r\n        }\r\n    }\r\n    getAppleDevToken() {\r\n        this.http.get(this.baseUrl + 'playlist').subscribe(result => {\r\n            this.token = result;\r\n            this.ConfigureMusicKit();\r\n        }, error => console.error(error));\r\n    }\r\n    async CreatePlaylist() {\r\n        const headers = { 'Authorization': 'Bearer ' + this.token, 'Music-User-Token': this.music.api.userToken };\r\n        let result = await this.http.get('https://api.music.apple.com/v1/me/library/playlist-folders?filter[identity]=playlistsroot', { headers }).toPromise();\r\n        console.log(result);\r\n        const data = [];\r\n        for (const song of this.appleSongs) {\r\n            let temp = { id: song.id, type: 'songs' };\r\n            data.push(temp);\r\n        }\r\n        const tracks = { data: data };\r\n        const parentData = [{ id: result.meta.filters.identity.playlistsroot[0].id, type: 'library-playlist-folders' }];\r\n        const parent = { data: parentData };\r\n        const attributes = { description: this.playlist.description, name: this.playlist.name };\r\n        const relationships = { tracks: tracks, parent };\r\n        const dataToSend = { attributes: attributes, relationships: relationships };\r\n        let playlist = await this.http.post('https://api.music.apple.com/v1/me/library/playlists', JSON.stringify(dataToSend), { headers }).toPromise();\r\n        console.log(playlist);\r\n        this.creationSuccesful = true;\r\n    }\r\n    async onSubmit() {\r\n        this.appleSongs = [];\r\n        //this.playlist.songs = [];\r\n        let linkValue = this.linkControl.value;\r\n        const regex = '[0-9A-Za-z]+\\\\?';\r\n        let found = linkValue.match(regex);\r\n        let playlistId = found[0].slice(0, -1);\r\n        let data = { Id: playlistId };\r\n        const headers = { 'content-type': 'application/json' };\r\n        this.playlist = await this.http.post(this.baseUrl + 'playlist', JSON.stringify(data), { headers }).toPromise();\r\n        console.log(this.playlist);\r\n        await this.searchSong();\r\n        await this.music.authorize();\r\n        this.CreatePlaylist();\r\n    }\r\n}\r\nConverterComponent.ɵfac = function ConverterComponent_Factory(t) { return new (t || ConverterComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject('BASE_URL')); };\r\nConverterComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ConverterComponent, selectors: [[\"app-converter\"]], decls: 12, vars: 5, consts: [[1, \"align-items-center\", \"pt-5\", \"text-light\"], [1, \"text-center\"], [1, \"container\", \"text-center\", \"pt-5\"], [1, \"pr-5\", \"row\"], [1, \"col\"], [\"type\", \"text\", 1, \"playlist-link\", \"me-3\", \"form-control-lg\", 3, \"ngModel\", \"formControl\", \"ngModelChange\"], [1, \"btn-lg\", \"btn-primary\", 3, \"click\"], [\"class\", \"pt-5\", 4, \"ngIf\"], [1, \"pt-5\"], [4, \"ngFor\", \"ngForOf\"]], template: function ConverterComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"h1\", 1);\r\n        i0.ɵɵtext(2, \"All we need is the link to your playlist...\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(3, \"div\", 2);\r\n        i0.ɵɵelementStart(4, \"div\", 3);\r\n        i0.ɵɵelementStart(5, \"div\", 4);\r\n        i0.ɵɵelementStart(6, \"input\", 5);\r\n        i0.ɵɵlistener(\"ngModelChange\", function ConverterComponent_Template_input_ngModelChange_6_listener($event) { return ctx.default = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(7, \"button\", 6);\r\n        i0.ɵɵlistener(\"click\", function ConverterComponent_Template_button_click_7_listener() { return ctx.onSubmit(); });\r\n        i0.ɵɵtext(8, \"Go!\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(9, ConverterComponent_div_9_Template, 4, 1, \"div\", 7);\r\n        i0.ɵɵtemplate(10, ConverterComponent_div_10_Template, 4, 1, \"div\", 7);\r\n        i0.ɵɵtemplate(11, ConverterComponent_div_11_Template, 3, 0, \"div\", 7);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(6);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.default)(\"formControl\", ctx.linkControl);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.playlist.songs.length > 0);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.appleSongs.length > 0);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.creationSuccesful);\r\n    } }, directives: [i2.DefaultValueAccessor, i2.NgControlStatus, i2.FormControlDirective, i3.NgIf, i3.NgForOf], styles: [\".playlist-link[_ngcontent-%COMP%] {\\r\\n    width: 50%\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnZlcnRlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0k7QUFDSiIsImZpbGUiOiJjb252ZXJ0ZXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5wbGF5bGlzdC1saW5rIHtcclxuICAgIHdpZHRoOiA1MCVcclxufVxyXG4iXX0= */\"] });\r\n"]},"metadata":{},"sourceType":"module"}